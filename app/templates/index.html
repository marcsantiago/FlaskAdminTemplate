{% extends "base.html" %}
{% block headline %}Quick View{% endblock %}
{% block headline2 %}{% endblock %}
{% block page_content %}
  <!--START TWITTER PORTLET-->
   <div class="col-md-6">
     <div id="portlet-linear" class="panel panel-default">
       <div class="panel-heading ">
         <div class="panel-title">Twitter App</div>
         <div class="panel-controls">
           <ul>
             <li><a href="#" class="portlet-collapse" data-toggle="collapse"><i class="portlet-icon portlet-icon-collapse"></i></a>
             </li>
             <li><a href="#" class="portlet-refresh" data-toggle="refresh"><i class="portlet-icon portlet-icon-refresh"></i></a>
             </li>
             <li><a href="#" class="portlet-close" data-toggle="close"><i class="portlet-icon portlet-icon-close"></i></a>
             </li>
           </ul>
         </div>
       </div>
       <div class="panel-body">
         <h3><span class="semi-bold">Status: </span><span id="twitter_status"></span></h3>
         <h4><span class="semi-bold">Last Tweet: </span></h4>
         <p>{{twitter_entry}}</p>
       </div>
     </div>
   </div>
   <!--END TWITTER PORTLET-->
   <!--START LAMP PORTLET-->
    <div class="col-md-6">
      <div id="portlet-linear" class="panel panel-default">
        <div class="panel-heading ">
          <div class="panel-title">Desk Lamp App</div>
          <div class="panel-controls">
            <ul>
              <li><a href="#" class="portlet-collapse" data-toggle="collapse"><i class="portlet-icon portlet-icon-collapse"></i></a>
              </li>
              <li><a href="#" class="portlet-refresh" data-toggle="refresh"><i class="portlet-icon portlet-icon-refresh"></i></a>
              </li>
              <li><a href="#" class="portlet-close" data-toggle="close"><i class="portlet-icon portlet-icon-close"></i></a>
              </li>
            </ul>
          </div>
        </div>
        <div class="panel-body">
          <h3><span class="semi-bold">Status: </span><span id="lamp_status"></span></h3>
          <h4><span class="semi-bold">Energy Information: </span></h4>
          <span >
            <p>Total Hours On: {{hours}}</p>
            <span style="width:auto; float:right;">
              <button id="toggle" type="button" class="btn btn-default btn-cons" data-toggle="button" aria-pressed="true"></button>
            </span>
          </span>
          <p>Cost: ${{cost}}</p>
        </div>
      </div>
    </div>
    <!--END LAMP PORTLET-->
    <br>
    <br>
    <br>
    <br>
{% endblock %}

{% block scripts %}
{{super()}}
  <script>
  $(function() {
    // lamp button
     var button = $("#toggle");
    // set twitter label
    {% if twitter_status == 'On' %}
      $('#twitter_status').html('Twitter Bot Is Running').css('color', 'green');
    {% else %}
      $('#twitter_status').html('Twitter Bot Is not Running').css('color', 'red');
    {% endif %}
    // set lamp label and button
    {% if lamp_status == 'On' %}
      $('#lamp_status').html('Light Is On').css('color', 'green');
      button.text('Turn Off').css('color', 'green');
    {% else %}
      $('#lamp_status').html('Light Is Off').css('color', 'red');
      button.text('Turn On').css('color', 'red');
    {% endif %}
    // update db information and change button information for light
    $("#toggle").click(function() {
      var text = button.text().split(' ')[1];
      $.post( "/vnvo", {'toggled': text}, function(data) {
      });
      if(text == 'On'){
        button.text('Turn Off').css('color', 'green');
        $('#lamp_status').html('Light Is On');
      }
      else{
        button.text('Turn On').css('color', 'red');
        $('#lamp_status').html('Light Is Off');
        setTimeout("location.reload();", 1000);
      }
    });
  //End of onload
  });
  </script>
{% endblock %}